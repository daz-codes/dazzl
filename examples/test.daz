# Dazzl Feature Showcase
# This file demonstrates all language features

# =============================================================================
# Variables and Basic Types
# =============================================================================

greeting = "Hello from Dazzl!"
x = 10
y = 20

console.log(greeting)

# Nil/null/undefined
empty = nil
also_null = null
not_defined = undefined

# Booleans
active = true
disabled = false

# Symbols (like Ruby/Elixir atoms)
status = :active
console.log(status)

# =============================================================================
# Strings
# =============================================================================

# Basic strings
name = "World"
single_quoted = 'no interpolation here: #{name}'

# String interpolation (double quotes only)
console.log("Hello #{name}!")
console.log("Math: 2 + 2 = #{2 + 2}")
console.log("Chained: #{String.upcase(name)}")

# Multiline strings
multiline = "Line 1
Line 2
Line 3"
console.log(multiline)

# =============================================================================
# Numbers and Operators
# =============================================================================

# Arithmetic
console.log(10 + 5)
console.log(10 - 5)
console.log(10 * 5)
console.log(10 / 4)

# Integer division and modulo
console.log(10 // 3)       # 3 (floor division)
console.log(17 % 5)        # 2 (modulo)
console.log(-17 // 5)      # -4 (floors toward negative infinity)

# Exponentiation (right-associative)
console.log(2 ** 10)       # 1024
console.log(2 ** 3 ** 2)   # 512 (= 2^9)

# Unary operators
console.log(-42)
console.log(+42)
console.log(-(-5))         # 5

# =============================================================================
# Arrays and Objects
# =============================================================================

# Arrays
empty_arr = []
numbers = [1, 2, 3, 4, 5]
mixed = ["hello", 42, true, nil]
console.log(numbers)

# Objects - three styles
obj1 = { name: "Alice", age: 30 }           # colon style
obj2 = { name => "Bob", age => 25 }         # hash rocket style
person_name = "Charlie"
person_age = 35
obj3 = { person_name, person_age }          # shorthand style
obj4 = { person_name, city: "NYC", active => true }  # mixed
console.log(obj1)
console.log(obj4)

# =============================================================================
# Functions (four equivalent styles)
# =============================================================================

# Haskell-style
add a, b = a + b

# Math-style
squared(n) = n * n

# Arrow-style
multiply: a, b -> a * b

# Arrow-style with parens
triple: (n) -> n * 3

console.log(add(x, y))      # 30
console.log(squared(6))     # 36
console.log(multiply(3, 4)) # 12
console.log(triple(5))      # 15

# Block body with implicit return
clamp: (val, min, max) -> {
  if val < min { return min }
  if val > max { return max }
  val
}
console.log(clamp(50, 0, 100))   # 50
console.log(clamp(-10, 0, 100))  # 0

# =============================================================================
# Control Flow
# =============================================================================

result = 30

# If/else with optional parentheses
if result == 30 {
  console.log("Math works!")
} else {
  console.log("Something is wrong")
}

# Unless (negated if)
unless result == 0 {
  console.log("Result is not zero")
}

# Postfix conditionals
console.log("Postfix if works!") if result == 30
console.log("This won't print") unless result == 30

# Conditional expressions (like ternary)
level = if result > 50 "high" else "low"
sign = if result > 0 then "positive" else "non-positive"
grade = if result > 90 "A" else if result > 80 "B" else "C"
console.log("Level: #{level}, Sign: #{sign}, Grade: #{grade}")

# =============================================================================
# Pipe Operator
# =============================================================================

# Pipes pass the left side as the first argument
result |> add(5) |> console.log    # 35

# Works great with String module
"  HELLO  " |> String.trim |> String.downcase |> console.log  # "hello"

# =============================================================================
# Nil Checking
# =============================================================================

# nil == checks for both null AND undefined
maybe_null = null
maybe_undef = undefined
console.log(maybe_null == nil)   # true
console.log(maybe_undef == nil)  # true
console.log(42 == nil)           # false

# =============================================================================
# Ranges
# =============================================================================

my_range = [1..5]
console.log(Range.to_list(my_range))    # [1, 2, 3, 4, 5]
console.log(Range.size(my_range))       # 5
console.log(Range.member(my_range, 3))  # true

# =============================================================================
# Kernel Functions (auto-imported)
# =============================================================================

# Type checking
console.log(is_integer(42))
console.log(is_float(3.14))
console.log(is_binary("hello"))
console.log(is_sym(:test))
console.log(is_list([1, 2, 3]))
console.log(is_range(my_range))

# Utilities
console.log(abs(-5))
console.log(length("hello"))
console.log(inspect(:active))

# =============================================================================
# String Module (Elixir-style)
# =============================================================================

console.log(String.first("elixir"))           # "e"
console.log(String.last("elixir"))            # "r"
console.log(String.at("elixir", 2))           # "i"
console.log(String.at("elixir", -1))          # "r"
console.log(String.capitalize("hELLO"))       # "Hello"
console.log(String.reverse("dazzl"))          # "lzzad"
console.log(String.contains("hello", "ell"))  # true
console.log(String.pad_leading("42", 5, "0")) # "00042"
console.log(String.duplicate("na", 4))        # "nananana"

# =============================================================================
# Integer Module (Elixir-style)
# =============================================================================

console.log(Integer.is_even(42))        # true
console.log(Integer.is_odd(7))          # true
console.log(Integer.digits(1234))       # [1, 2, 3, 4]
console.log(Integer.digits(255, 16))    # [15, 15]
console.log(Integer.undigits([1, 2, 3]))# 123
console.log(Integer.gcd(12, 8))         # 4
console.log(Integer.pow(2, 10))         # 1024
console.log(Integer.to_string(255, 16)) # "ff"

# =============================================================================
# Pattern-Matching Functions
# =============================================================================

# Factorial with pattern matching
factorial 0 = 1
factorial n = n * factorial(n - 1)
console.log(factorial(5))   # 120
console.log(factorial(0))   # 1

# Fibonacci with pattern matching
fib 0 = 0
fib 1 = 1
fib n = fib(n - 1) + fib(n - 2)
console.log(fib(10))        # 55

# String pattern matching
greet "world" = "Hello World!"
greet name = "Hello #{name}!"
console.log(greet("world"))     # "Hello World!"
console.log(greet("Dazzl"))     # "Hello Dazzl!"

# Multiple parameters with wildcards
pair_type 0, 0 = "both zero"
pair_type 0, _ = "first zero"
pair_type _, 0 = "second zero"
pair_type _, _ = "neither zero"
console.log(pair_type(0, 0))    # "both zero"
console.log(pair_type(0, 5))    # "first zero"
console.log(pair_type(5, 0))    # "second zero"
console.log(pair_type(3, 7))    # "neither zero"

# Boolean pattern matching
to_yn true = "yes"
to_yn false = "no"
console.log(to_yn(true))        # "yes"
console.log(to_yn(false))       # "no"
